<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retos Estrat√©gicos 2026 - VPRE ANI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, 
                #003F78 0%,
                #575756 35%,
                #EC6608 70%,
                #003F78 100%
            );
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center, 
                rgba(0, 63, 120, 0.3) 0%,
                rgba(87, 87, 86, 0.4) 50%,
                rgba(236, 102, 8, 0.2) 100%
            );
            pointer-events: none;
        }

        .nav-header {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-button {
            background: linear-gradient(135deg, #EC6608, #d97706);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .back-button:hover {
            transform: translateX(-5px);
            box-shadow: 0 5px 15px rgba(236, 102, 8, 0.4);
        }

        .nav-title {
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .filter-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .filter-select {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            backdrop-filter: blur(5px);
        }

        .filter-select option {
            background: #333;
            color: white;
        }

        .main-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #EC6608, #f59e0b, #EC6608);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .hero-subtitle {
            color: #e8eaed;
            font-size: 1.3rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Dashboard Ejecutivo */
        .executive-dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 25px;
            margin-bottom: 40px;
        }

        /* Panel de M√©tricas */
        .metrics-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            animation: fadeInLeft 0.8s ease;
        }

        .metrics-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .metric-item:hover {
            background: #f9fafb;
            margin: 0 -10px;
            padding: 15px 10px;
            border-radius: 10px;
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #6b7280;
            font-weight: 500;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: #1f2937;
        }

        .metric-badge {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .badge-alto { background: #dc2626; }
        .badge-medio { background: #f59e0b; }
        .badge-gits { background: #10b981; }
        .badge-riesgo { background: #eab308; }

        /* Mapa de Calor Interactivo - COLORES INSTITUCIONALES ACTUALIZADOS */
        .heatmap-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            animation: fadeInUp 0.8s ease;
        }

        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            background: white;
            border: 2px solid transparent;
            text-align: center;
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        /* COLORES INSTITUCIONALES SERIOS */
        .heatmap-cell.critical {
            background: linear-gradient(135deg, #7f1d1d, #991b1b);
            color: white;
            border-color: #450a0a;
        }
        .heatmap-cell.high {
            background: linear-gradient(135deg, #92400e, #b45309);
            color: white;
            border-color: #78350f;
        }
        .heatmap-cell.medium {
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            color: white;
            border-color: #1e40af;
        }
        .heatmap-cell.low {
            background: linear-gradient(135deg, #065f46, #047857);
            color: white;
            border-color: #064e3b;
        }
        .heatmap-cell.none {
            background: linear-gradient(135deg, #6b7280, #9ca3af);
            color: white;
            border-color: #4b5563;
        }

        .cell-git {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        .cell-count {
            font-size: 1.8rem;
            font-weight: 800;
        }
        .cell-label {
            font-size: 0.7rem;
            margin-top: 2px;
            opacity: 0.9;
        }

        /* Panel de Prioridades */
        .priority-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            animation: fadeInRight 0.8s ease;
        }

        .priority-list { list-style: none; }

        .priority-item {
            background: linear-gradient(135deg, #fff, #f9fafb);
            border-left: 4px solid #EC6608;
            padding: 12px 15px;
            margin-bottom: 12px;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .priority-item:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .priority-item.critical { border-left-color: #dc2626; }

        .priority-text {
            font-size: 0.9rem;
            color: #374151;
            font-weight: 500;
        }

        /* GR√ÅFICO DE BARRAS - TAMA√ëO REDUCIDO */
        .progress-chart {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px; /* Reducido de 30px a 20px */
            margin-bottom: 30px; /* Reducido de 40px a 30px */
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px; /* Reducido de 25px a 15px */
        }
        .chart-title {
            font-size: 1.3rem; /* Reducido de 1.5rem a 1.3rem */
            font-weight: 700;
            color: #1f2937;
        }
        .chart-legend {
            display: flex;
            gap: 15px; /* Reducido de 20px a 15px */
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px; /* Reducido de 8px a 6px */
            font-size: 0.85rem; /* Reducido de 0.9rem a 0.85rem */
            color: #6b7280;
        }
        .legend-color {
            width: 12px; /* Reducido de 15px a 12px */
            height: 12px; /* Reducido de 15px a 12px */
            border-radius: 3px; /* Reducido de 4px a 3px */
        }
        .progress-bars {
            display: grid;
            gap: 12px; /* Reducido de 20px a 12px */
        }
        .progress-bar-item {
            display: grid;
            grid-template-columns: 130px 1fr 45px; /* Reducido de 150px 1fr 50px */
            align-items: center;
            gap: 12px; /* Reducido de 15px a 12px */
        }
        .bar-label {
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem; /* Reducido de 0.95rem a 0.9rem */
            text-align: right;
        }
        .bar-container {
            height: 28px; /* Reducido de 35px a 28px */
            background: #e9ecef;
            border-radius: 6px; /* Reducido de 8px a 6px */
            overflow: hidden;
            position: relative;
            display: flex;
        }
        .bar-fill {
            height: 100%;
            transition: width 1s ease;
        }
        .bar-fill-alto { background-color: #dc2626; }
        .bar-fill-medio { background-color: #f59e0b; }
        
        .bar-inner-label {
            position: absolute;
            left: 10px; /* Reducido de 12px a 10px */
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 0.8rem; /* Reducido de 0.9rem a 0.8rem */
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
            pointer-events: none;
        }
        .bar-total-count {
            font-weight: 700;
            color: #374151;
            font-size: 1rem; /* Reducido de 1.1rem a 1rem */
            text-align: center;
        }

        /* Tarjetas de Retos */
        .challenges-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .challenge-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            animation: fadeInUp 0.8s ease both;
            position: relative;
            display: none; /* Hidden by default, shown by JS */
        }

        .challenge-card.visible {
            display: block;
        }

        .challenge-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .challenge-header {
            padding: 20px;
            background: linear-gradient(135deg, #003F78, #005aab);
            color: white;
            position: relative;
        }

        .challenge-git {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .challenge-title {
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.3;
        }

        .challenge-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
        }
        .challenge-badge.alto {
             background: #dc2626;
             color: white;
        }
         .challenge-badge.medio {
             background: #f59e0b;
             color: white;
        }

        .challenge-body { padding: 20px; }
        .challenge-section { margin-bottom: 20px; }
        .section-label {
            font-size: 0.8rem;
            color: #6b7280;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .section-content {
            color: #374151;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Modal de Detalles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 25px;
            max-width: 900px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }
        .modal-header {
            padding: 30px;
            background: linear-gradient(135deg, #003F78, #005aab);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .modal-title-text {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .modal-body { padding: 30px; }
        .modal-section { margin-bottom: 30px; }
        .modal-section-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #EC6608;
            padding-bottom: 8px;
        }
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        .modal-body ul {
            list-style: none;
            padding-left: 5px;
        }
        .modal-body li {
            padding: 8px 0 8px 25px;
            position: relative;
            line-height: 1.5;
        }
        .modal-body li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #EC6608;
            font-weight: bold;
        }

        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Media Queries */
        @media (max-width: 1200px) {
            .executive-dashboard { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .hero-title { font-size: 2rem; }
            .challenges-container { grid-template-columns: 1fr; }
            .heatmap-grid { grid-template-columns: repeat(2, 1fr); }
            .nav-title { display: none; }
            .progress-bar-item { grid-template-columns: 90px 1fr 35px; gap: 8px; }
            .bar-label { text-align: left; font-size: 0.8rem; }
        }
    </style>
    <style>
      @media print {

        /* --- CONFIGURACI√ìN GENERAL DE LA P√ÅGINA --- */
        @page {
          size: A4 landscape; /* Hoja en formato horizontal */
          margin: 0; /* Sin m√°rgenes */
        }

        /* --- AJUSTES DEL CUERPO DEL DOCUMENTO --- */
        body {
          background: #FFFFFF !important; /* Fondo totalmente blanco */
          color: #000000 !important; /* Texto principal en negro */
          min-height: 0 !important;
          height: 100vh; /* Forzar altura a una p√°gina */
          overflow: hidden; /* Evitar desbordamientos */
        }
        
        /* --- OCULTAR ELEMENTOS INNECESARIOS --- */
        body::before, body::after, .background-particles, .floating-help, .footer {
          display: none !important; /* Oculta fondos, part√≠culas, bot√≥n de ayuda y footer */
        }

        /* --- AJUSTAR CONTENIDO PRINCIPAL --- */
        .main-container {
          padding-top: 20px !important; /* Menos espacio arriba */
          padding-bottom: 20px !important; /* Menos espacio abajo */
          max-width: 100% !important;
        }

        /* --- AJUSTAR T√çTULOS Y TEXTOS --- */
        .main-title, .main-subtitle, .main-description, .footer-info h3, .footer-info p {
          color: #000000 !important; /* Asegurar que todo el texto sea negro */
          text-shadow: none !important; /* Quitar sombras */
        }
        .main-title {
          -webkit-text-fill-color: initial !important; /* Anular el color de gradiente */
          background: none !important;
          font-size: 3rem !important; /* Un poco m√°s peque√±o para que quepa bien */
        }
        
        /* --- AJUSTAR LOGO --- */
        .ani-logo {
          width: 100px !important;
          height: 100px !important;
          box-shadow: none !important;
        }
        .logo-image {
          width: 100px !important;
          height: 100px !important;
        }
        
        /* --- REORGANIZAR LAS TARJETAS PARA QUE QUEPAN --- */
        .cards-grid {
          display: grid;
          /* Forzar una cuadr√≠cula de 4 columnas y 2 filas */
          grid-template-columns: repeat(4, 1fr) !important;
          grid-template-rows: repeat(2, auto) !important;
          gap: 15px !important; /* Reducir espacio entre tarjetas */
          padding: 10px !important;
        }

        .module-card {
          transform: none !important; /* Quitar efectos de hover */
          box-shadow: 0 4px 6px rgba(0,0,0,0.1) !important; /* Sombra sutil para impresi√≥n */
          padding: 15px !important; /* Menos espacio interno */
          border: 1px solid #ccc !important; /* Borde simple */
          page-break-inside: avoid; /* Evitar que una tarjeta se parta en dos p√°ginas */
        }
        
        /* --- AJUSTAR TEXTO DENTRO DE LAS TARJETAS --- */
        .card-title {
            font-size: 1.1rem !important;
        }
        .card-description {
            font-size: 0.85rem !important;
            line-height: 1.4 !important;
            margin-bottom: 10px !important;
        }
        .stat-number {
            font-size: 1.3rem !important;
        }

        /* Quitar animaciones */
        * {
           animation: none !important;
           transition: none !important;
        }
      }
    </style>
</head>
<body>
    <nav class="nav-header">
        <button class="back-button" onclick="goBack()">
            ‚Üê Volver al Tablero Principal
        </button>
        <div class="nav-title">Retos Estrat√©gicos 2026</div>
        <div class="filter-controls">
            <select class="filter-select" id="impactFilter">
                <option value="all">Todos los Impactos</option>
                <option value="alto">Alto Impacto</option>
                <option value="medio">Medio Impacto</option>
            </select>
            <select class="filter-select" id="gitFilter">
                <option value="all">Todos los GITs</option>
            </select>
        </div>
    </nav>

    <div class="main-container">
        <div class="hero-section">
            <h1 class="hero-title">RETOS ESTRAT√âGICOS 2026</h1>
            <p class="hero-subtitle">Dashboard Ejecutivo de Desaf√≠os y Propuestas de Abordaje</p>
        </div>

        <div class="executive-dashboard">
            <div class="metrics-panel" id="metrics-panel"></div>
            <div class="heatmap-panel" id="heatmap-panel"></div>
            <div class="priority-panel" id="priority-panel"></div>
        </div>

        <div class="progress-chart" id="progress-chart"></div>

        <div class="challenges-container" id="challenges-container"></div>
    </div>

    <div class="modal" id="challenge-modal">
        <div class="modal-content">
            <div class="modal-header" id="modal-header">
                <button class="modal-close" id="modal-close-btn">&times;</button>
                <h2 class="modal-title-text" id="modal-title"></h2>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

<script>
// ===================================================================================
// DATA SOURCE
// ===================================================================================
const challengesData = [
    // --- GIT SOCIAL (2) ---
    {id: 1, git: 'Social', title: 'Consolidaci√≥n de un equipo en el GIT Social para el desarrollo de las consultas previas.', impact: 'alto', status: 'en-riesgo', progress: 20, proposal: '<ul><li>Conformar un equipo interdisciplinario con experiencia en derecho √©tnico, antropolog√≠a y gesti√≥n social.</li><li>Dise√±ar un plan de formaci√≥n interna sobre normativas y buenas pr√°cticas en consulta previa.</li><li>Establecer una hoja de ruta metodol√≥gica institucional para el acompa√±amiento de los procesos.</li><li>Coordinar con el Ministerio del Interior y otras entidades competentes para garantizar articulaci√≥n y cumplimiento normativo.</li></ul>', impact_detail: 'Sin este equipo, la Agencia enfrenta: Retrasos en cronogramas de obra, Riesgos legales y sociales por incumplimientos normativos, y P√©rdida de legitimidad frente a las comunidades √©tnicas.'},
    {id: 2, git: 'Social', title: 'Consolidaci√≥n de un equipo en el GIT Social para la atenci√≥n a la conflictividad social.', impact: 'alto', status: 'en-progreso', progress: 40, proposal: '<ul><li>Estructurar un equipo de apoyo para la gesti√≥n de conflictividad social dentro de la Agencia.</li><li>Vincular profesionales con experiencia en mediaci√≥n, negociaci√≥n y an√°lisis de conflictos territoriales.</li><li>Implementar protocolos de atenci√≥n temprana y seguimiento de alertas sociales.</li><li>Fortalecer la articulaci√≥n con actores locales, autoridades y l√≠deres comunitarios para la prevenci√≥n y resoluci√≥n de conflictos.</li></ul>', impact_detail: 'La ausencia de un equipo especializado impide abordar de manera asertiva y oportuna las conflictividades en los territorios, lo que genera impactos negativos en la imagen institucional y debilita la relaci√≥n con las comunidades.'},
    
    // --- GIT AMBIENTAL (3) ---
    {id: 3, git: 'Ambiental', title: 'Fortalecer e implementar los instrumentos de la gesti√≥n del GIT Ambiental.', impact: 'alto', status: 'en-riesgo', progress: 15, proposal: '<ul><li>Implementar la Estrategia de Sostenibilidad</li><li>Implementar el Plan de Gesti√≥n de Riesgos de la Entidad (Obligaci√≥n incumplida desde el 2012)</li><li>Ampliaci√≥n del alcance de BIO ANI.</li></ul>', impact_detail: 'El no fortalecimiento de la gesti√≥n ambiental expone a la entidad a sanciones, retrasos y sobrecostos en los proyectos.'},
    {id: 4, git: 'Ambiental', title: 'Fortalecer la defensa jur√≠dica para el componente ambiental.', impact: 'alto', status: 'en-progreso', progress: 30, proposal: '<ul><li>Gesti√≥n interinstitucional para articular una defensa unificada del estado en materia ambiental.</li><li>Ajuste de los procedimientos internos para incorporar mecanismos prospectivos de cambio clim√°tico.</li></ul>', impact_detail: 'Una defensa jur√≠dica d√©bil puede resultar en fallos adversos, multas y paralizaci√≥n de proyectos por temas ambientales.'},
    {id: 5, git: 'Ambiental', title: 'Saneamiento de expedientes ambientales en titularidad de la ANI.', impact: 'alto', status: 'no-iniciado', progress: 5, proposal: '<ul><li>Desarrollar una estrategia para gesti√≥n de pendientes ambientales y eventuales pasivos ambientales.</li></ul>', impact_detail: 'La falta de saneamiento puede derivar en pasivos ambientales no identificados, con altos costos financieros y reputacionales a futuro.'},

    // --- GIT PREDIAL (4) ---
    {id: 6, git: 'Predial', title: 'Garantizar el 90% de la longitud efectiva predial requerida para la ejecuci√≥n de los proyectos de infraestructura 4G.', impact: 'alto', status: 'en-progreso', progress: 75, proposal: '<p>Seguimiento del GIT Predial y monitoreo coordinado con las interventor√≠as de los proyectos frente a la gesti√≥n de permisos de intervenci√≥n voluntaria y/o adquisici√≥n de predios requeridos para la ejecuci√≥n de proyectos, de tal forma de garantizar la armon√≠a con plan de obras del proyecto.</p>', impact_detail: 'Armon√≠a con plan de obras del proyecto y ejecuci√≥n oportuna de estas.'},
    {id: 7, git: 'Predial', title: 'Adquirir el 80% de los predios que fueron requeridos para la ejecuci√≥n de los proyectos de infraestructura 4G. Y el 10% de los predios para 5G.', impact: 'alto', status: 'completado', progress: 100, proposal: '<p>Seguimiento del GIT Predial y monitoreo coordinado con las interventor√≠as de los proyectos frente a la culminaci√≥n de los procesos de gesti√≥n predial bien sea mediante mecanismo de enajenaci√≥n voluntaria y/o expropiaci√≥n judicial.</p>', impact_detail: 'Cumplimiento de las disposiciones contractuales relacionadas con la gesti√≥n y adquisici√≥n predial bajo la titularidad de la ANI.'},
    {id: 8, git: 'Predial', title: 'Garantizar el 40% de la longitud efectiva predial requerida para el inicio de la etapa de construcci√≥n de los proyectos de infraestructura 5G.', impact: 'alto', status: 'en-progreso', progress: 50, proposal: '<p>Seguimiento del GIT Predial y monitoreo coordinado con las interventor√≠as de los proyectos frente a la gesti√≥n de permisos de intervenci√≥n voluntaria y/o adquisici√≥n de predios requeridos para el inicio de la fase de construcci√≥n de las Unidades Funcionales de los Proyectos.</p>', impact_detail: 'Cumplimiento del requisito contractual para suscribir acta de inicio de la fase de construcci√≥n de las UF.'},
    {id: 9, git: 'Predial', title: 'Obtener como m√≠nimo la adjudicaci√≥n y titularidad a favor de la Agencia del 20% de predios de naturaleza bald√≠a.', impact: 'alto', status: 'en-riesgo', progress: 10, proposal: '<p>Seguimiento, monitoreo y gesti√≥n interinstitucional entre el GIT Predial de la ANI y de la Agencia Nacional de Tierras con el fin de dar celeridad a la resoluci√≥n de tr√°mites de adjudicaci√≥n de predios bald√≠os actualmente en curso.</p>', impact_detail: 'Demora en el tr√°mite de adjudicaci√≥n de predios bald√≠os a la entidad de derecho p√∫blico (ANI). Incidencia en el procedimiento contractual de verificaci√≥n predial.'},

    // --- GIT JUR√çDICA PREDIAL (6) ---
    {id: 10, git: 'Jur√≠dica Predial', title: 'Cerrar integralmente la gesti√≥n predial de la Concesi√≥n Armenia‚ÄìPereira‚ÄìManizales antes de la reversi√≥n (1er Trim del 2027).', impact: 'medio', status: 'en-progreso', progress: 60, proposal: '<ul><li>Plan de trabajo detallado con todas las actividades de verificaci√≥n a cargo de la interventor√≠a.</li><li>Informes mensuales de avance que muestren resultados concretos de cada actividad.</li><li>Generaci√≥n oportuna de requerimientos al concesionario cuando haya lugar a ello.</li></ul>', impact_detail: 'La ejecuci√≥n oportuna de esta actividad es importante para determinar el estado de cumplimiento del concesionario y con base en ello hacer los requerimientos a que haya lugar previo a la reversi√≥n del contrato.'},
    {id: 11, git: 'Jur√≠dica Predial', title: 'Completar integralmente la gesti√≥n predial del Proyecto "Desarrollo vial del oriente de Medell√≠n" antes de la reversi√≥n (31 de julio de 2026).', impact: 'medio', status: 'en-progreso', progress: 55, proposal: '<ul><li>Plan de trabajo detallado con todas las actividades de verificaci√≥n a cargo de la interventor√≠a.</li><li>Informes mensuales de avance que muestren resultados concretos de cada actividad.</li><li>Generaci√≥n oportuna de requerimientos al concesionario cuando haya lugar a ello.</li></ul>', impact_detail: 'El incumplimiento en la gesti√≥n de los predios pendientes puede afectar el cierre del contrato, las obras y generar controversias, por lo que es clave verificar el cumplimiento del concesionario antes de la reversi√≥n.'},
    {id: 12, git: 'Jur√≠dica Predial', title: 'Malla Vial Valle del Cauca y Cauca: Terminaci√≥n del proceso de expropiaci√≥n con radicado No. 2006-00068 (Predio Parador de Buga).', impact: 'alto', status: 'en-riesgo', progress: 25, proposal: '<ul><li>Impulsar el tr√°mite judicial hasta alcanzar, como m√≠nimo, segunda instancia durante 2026.</li><li>Presentar argumentos jur√≠dicos y t√©cnicos contra cualquier tasaci√≥n de indemnizaci√≥n desfavorable.</li><li>Ejercer todas las herramientas procesales necesarias.</li><li>Seguimiento proactivo de cada actuaci√≥n judicial.</li></ul>', impact_detail: 'La prolongaci√≥n de un proceso judicial que ya lleva m√°s de 19 a√±os pone en riesgo la culminaci√≥n de la expropiaci√≥n y expone a la ANI a un pasivo de indemnizaci√≥n de COP 16.340.486.643.'},
    {id: 13, git: 'Jur√≠dica Predial', title: 'Liquidaci√≥n del proyecto Perimetral de Oriente: Obtener cierre de la gesti√≥n predial.', impact: 'alto', status: 'no-iniciado', progress: 10, proposal: '<p>Seguimiento del cumplimiento de las etapas establecidas mitigando el riesgo de pasivos prediales.</p>', impact_detail: 'La falta de cierre de la gesti√≥n predial puede generar pasivos y contingencias para la entidad.'},
    {id: 14, git: 'Jur√≠dica Predial', title: 'Concluir el proceso de expropiaci√≥n contra Jos√© Antenor Gonz√°lez (Proyecto BGG).', impact: 'alto', status: 'en-progreso', progress: 50, proposal: '<ul><li>Agotar los mecanismos procesales para garantizar que la diligencia de entrega se realice sin dilaciones.</li><li>Apoyarse en los poderes de ordenaci√≥n e instrucciones de los Jueces.</li><li>Monitoreo continuo del proceso.</li></ul>', impact_detail: 'La presentaci√≥n de oposiciones podr√≠a impedir la transferencia del predio, paralizando la ampliaci√≥n del tercer carril Bogot√°‚ÄìGirardot.'},
    {id: 15, git: 'Jur√≠dica Predial', title: 'Culminar cerca de 105 procesos de expropiaci√≥n a cargo de la ANI.', impact: 'medio', status: 'en-riesgo', progress: 30, proposal: '<ul><li>Impulsar con agilidad cada proceso de expropiaci√≥n.</li><li>Monitoreo centralizado del avance de los 105 casos.</li><li>Escalamiento inmediato de obst√°culos.</li></ul>', impact_detail: 'La falta de titulaci√≥n de estas √°reas compromete la ejecuci√≥n de fases clave en los proyectos, generando retrasos y sobrecostos.'},

    // --- GIT RIESGOS (2) ---
    {id: 16, git: 'Riesgos', title: 'Implementar los mecanismos no l√≠quidos de compensaci√≥n de riesgos para proyectos de iniciativa privada.', impact: 'alto', status: 'no-iniciado', progress: 10, proposal: '<p>Formalizar la metodolog√≠a para la aplicaci√≥n de los mecanismos de compensaci√≥n de riesgos no l√≠quidos.</p>', impact_detail: 'Esencial para garantizar la continuidad y viabilidad financiera de los proyectos de iniciativa privada.'},
    {id: 17, git: 'Riesgos', title: 'Formalizar jur√≠dicamente la metodolog√≠a de tarifas diferenciales en peajes.', impact: 'medio', status: 'en-progreso', progress: 45, proposal: '<p>Motivar la expedici√≥n de la metodolog√≠a de tarifas diferenciales para los proyectos carreteros de la ANI por parte del Ministerio de Transporte.</p>', impact_detail: 'Sirve como herramienta de di√°logo en mesas de trabajo con las comunidades para mitigar conflictos sociales.'},

    // --- GIT PLANEACI√ìN (4) ---
    {id: 18, git: 'Planeaci√≥n', title: 'Optimizaci√≥n y automatizaci√≥n de actividades de la OETR.', impact: 'alto', status: 'en-progreso', progress: 50, proposal: '<ul><li>Definir y establecer los requerimientos funcionales de las mejoras y desarrollo de ANISCOPIO en conjunto con GIT TIC.', impact_detail: 'Reducir los tiempos en la fase de acopio y procesamiento de la OETR, que permita potenciar la fase de an√°lisis y mejora en la oportunidad de difusi√≥n de la informaci√≥n estad√≠stica.'},
    {id: 19, git: 'Planeaci√≥n', title: 'Posicionar la informaci√≥n estad√≠stica producida por la OETR.', impact: 'alto', status: 'en-progreso', progress: 50, proposal: '<ul><li>Mejora continua de los productos y aumento de los canales de difusi√≥n incluyendo redes sociales, con el soporte y apoyo de la oficina de comunicaciones.</li></ul>', impact_detail: 'Aumentar el aprovechamiento de la informaci√≥n de la OETR por parte de los grupos de inter√©s internos y externos..'},
    {id: 20, git: 'Planeaci√≥n', title: 'Implementar  nuevo mapa de procesos - Redise√±o institucional.', impact: 'medio', status: 'en-progreso', progress: 50, proposal: '<p>Plantear y presentar plan de trabajo donde se aborde la actualizaci√≥n del mapa de procesos de la ANI con la documentaci√≥n anexa a cada proceso.</p>', impact_detail: ''},
    {id: 21, git: 'Planeaci√≥n', title: 'Gestionar al menos 3¬†alianzas que permitan¬†desarrollar ¬†los proyectos de infraestructura y transversales de la ANI a priorizar para la vigencia 2026 a trav√©s de cooperaci√≥n internacional.', impact: 'medio', status: 'en-progreso', progress: 50, proposal: '<ul><li>Continuar con el seguimiento a los aliados que manifestaron inter√©s en apoyar los proyectos de la ANI para establecer un plan de acci√≥n y continuar gestionando los espacios para la presentaci√≥n de los proyectos de la entidad¬†a actores internacionales./li></ul>', impact_detail: 'Seg√∫n el monto de la cooperaci√≥n financiera o las capacidades t√©cnicas fortalecidas se podr√°n ejecutar proyectos tanto de infraestructura como transversales de la entidad priorizados .'},
    

    // --- GIT TIC (3) ---
    {id: 22, git: 'TIC', title: 'Financiar con Vigencias futuras los proyectos que trascienden el a√±o fiscal actual.', impact: 'medio', status: 'en-progreso', progress: 50, proposal: '<p>Planificar y presentar con anticipaci√≥n los requerimientos de vigencias futuras para el GIT.</p>', impact_detail: 'Evitar la Interrupci√≥n de proyectos clave y la afectaci√≥n de la continuidad operativa.'},
    {id: 23, git: 'TIC', title: 'Implementar un plan sectorial para la gesti√≥n unificada y estandarizada de los datos maestros.', impact: 'alto', status: 'en-riesgo', progress: 15, proposal: '<p>Definir un marco de gobernanza de datos maestros, identificar datos cr√≠ticos, y establecer est√°ndares de calidad.</p>', impact_detail: 'Inconsistencia en la informaci√≥n, duplicidad de datos, y limitaciones en la interoperabilidad con otras entidades.'},
    {id: 24, git: 'TIC', title: 'Potenciar el equipo del GIT TIC.', impact: 'alto', status: 'en-riesgo', progress: 20, proposal: '<p>Apoyar los requerimientos de vigencias futuras para asegurar la contrataci√≥n del personal necesario.</p>', impact_detail: 'Retrasos en proyectos cr√≠ticos, sobrecarga laboral, disminuci√≥n de la calidad de los servicios de TI.'},

    // --- GIT VALORIZACI√ìN (1) ---
    {id: 25, git: 'Valorizaci√≥n', title: 'Analizar y verificar los recursos propios y del FIP para el presupuesto de la vigencia 2026.', impact: 'alto', status: 'en-progreso', progress: 80, proposal: '<p>Para asegurar la continuidad operativa y el correcto despliegue de la Contribuci√≥n Nacional de Valorizaci√≥n, es prioritario gestionar y asignar los recursos requeridos a nivel humano, tecnol√≥gico, f√≠sico e institucional.</p>', impact_detail: 'Asegurar el sostenimiento y continuidad del proceso de la Contribuci√≥n Nacional de Valorizaci√≥n (CNV).'}
];


// ===================================================================================
// L√ìGICA DEL DASHBOARD
// ===================================================================================
document.addEventListener('DOMContentLoaded', function() {
    
    // --- ELEMENTOS DEL DOM ---
    const impactFilterEl = document.getElementById('impactFilter');
    const gitFilterEl = document.getElementById('gitFilter');
    const challengesContainer = document.getElementById('challenges-container');
    const modal = document.getElementById('challenge-modal');
    const modalCloseBtn = document.getElementById('modal-close-btn');

    // --- INICIALIZACI√ìN ---
    function init() {
        populateGitFilter();
        renderAllComponents();
        setupEventListeners();
    }

    // --- L√ìGICA DE RENDERIZADO DE COMPONENTES ---

    function renderAllComponents() {
        renderMetrics();
        renderHeatmap();
        renderPriorityList();
        renderProgressChart();
        renderChallenges();
    }
    
    function populateGitFilter() {
        const gits = [...new Set(challengesData.map(c => c.git))];
        gits.sort();
        gits.forEach(git => {
            const option = document.createElement('option');
            option.value = git;
            option.textContent = `GIT ${git}`;
            gitFilterEl.appendChild(option);
        });
    }

    function renderMetrics() {
        const totalRetos = challengesData.length;
        const altoImpacto = challengesData.filter(c => c.impact === 'alto').length;
        const medioImpacto = challengesData.filter(c => c.impact === 'medio').length;
        const gitsActivos = [...new Set(challengesData.map(c => c.git))].length;
        const enRiesgo = challengesData.filter(c => c.status === 'en-riesgo').length;

        const html = `
            <h3 class="metrics-title"><span>üìä</span> M√©tricas Clave</h3>
            <div class="metric-item" onclick="applyFilters({ impact: 'all', git: 'all' })">
                <div class="metric-label"><span class="metric-badge" style="background: #003F78;"></span>Total Retos</div>
                <div class="metric-value">${totalRetos}</div>
            </div>
            <div class="metric-item" onclick="applyFilters({ impact: 'alto' })">
                <div class="metric-label"><span class="metric-badge badge-alto"></span>Alto Impacto</div>
                <div class="metric-value">${altoImpacto}</div>
            </div>
            <div class="metric-item" onclick="applyFilters({ impact: 'medio' })">
                <div class="metric-label"><span class="metric-badge badge-medio"></span>Medio Impacto</div>
                <div class="metric-value">${medioImpacto}</div>
            </div>
            <div class="metric-item" onclick="applyFilters({ status: 'en-riesgo' })">
                <div class="metric-label"><span class="metric-badge badge-riesgo"></span>En Riesgo</div>
                <div class="metric-value">${enRiesgo}</div>
            </div>
             <div class="metric-item">
                <div class="metric-label"><span class="metric-badge badge-gits"></span>GITs Activos</div>
                <div class="metric-value">${gitsActivos}</div>
            </div>
        `;
        document.getElementById('metrics-panel').innerHTML = html;
    }

    function renderHeatmap() {
        const gits = [...new Set(challengesData.map(c => c.git))];
        let gridHtml = '';
        gits.forEach(git => {
            const gitChallenges = challengesData.filter(c => c.git === git);
            const altoCount = gitChallenges.filter(c => c.impact === 'alto').length;
            const enRiesgoCount = gitChallenges.filter(c => c.status === 'en-riesgo').length;

            let cellClass = 'low';
            if (enRiesgoCount > 0) cellClass = 'high';
            if (enRiesgoCount >= 2 || altoCount >= 3) cellClass = 'critical';
            if (gitChallenges.length === 0) cellClass = 'none';
            else if (altoCount === 0 && enRiesgoCount === 0) cellClass = 'medium';

            gridHtml += `
                <div class="heatmap-cell ${cellClass}" onclick="applyFilters({ git: '${git}' })">
                    <div class="cell-git">${git}</div>
                    <div class="cell-count">${gitChallenges.length}</div>
                    <div class="cell-label">Alto: ${altoCount} / Riesgo: ${enRiesgoCount}</div>
                </div>
            `;
        });

        const html = `
            <h3 class="metrics-title"><span>üî•</span> Mapa de Calor por GIT</h3>
            <div class="heatmap-grid">${gridHtml}</div>`;
        document.getElementById('heatmap-panel').innerHTML = html;
    }

    function renderPriorityList() {
        const priorityChallenges = challengesData
            .filter(c => c.status === 'en-riesgo' || c.impact === 'alto')
            .sort((a, b) => {
                if (a.status === 'en-riesgo' && b.status !== 'en-riesgo') return -1;
                if (b.status === 'en-riesgo' && a.status !== 'en-riesgo') return 1;
                return 0;
            })
            .slice(0, 5);

        let listHtml = '';
        priorityChallenges.forEach(c => {
            listHtml += `
                <li class="priority-item ${c.status === 'en-riesgo' ? 'critical' : ''}" onclick="showModal(${c.id})">
                    <span class="priority-text">${c.title}</span>
                </li>`;
        });
        
        const html = `
            <h3 class="metrics-title"><span>üéØ</span> Top 5 Prioridades</h3>
            <ul class="priority-list">${listHtml}</ul>`;
        document.getElementById('priority-panel').innerHTML = html;
    }
    
    // --- FUNCI√ìN ACTUALIZADA DEL GR√ÅFICO ---
    function renderProgressChart() {
        const gitCounts = {};
        challengesData.forEach(c => {
            if (!gitCounts[c.git]) {
                gitCounts[c.git] = { total: 0, alto: 0, medio: 0 };
            }
            gitCounts[c.git].total++;
            if (c.impact === 'alto') gitCounts[c.git].alto++;
            if (c.impact === 'medio') gitCounts[c.git].medio++;
        });

        const sortedGits = Object.keys(gitCounts).sort((a, b) => gitCounts[b].total - gitCounts[a].total);

        let barsHtml = '';
        sortedGits.forEach(git => {
            const counts = gitCounts[git];
            const altoWidth = (counts.alto / counts.total) * 100;
            const medioWidth = (counts.medio / counts.total) * 100;
            const totalWidth = altoWidth + medioWidth;
            const label = `${counts.total} reto${counts.total > 1 ? 's' : ''}`;

            barsHtml += `
                <div class="progress-bar-item">
                    <div class="bar-label">${git}</div>
                    <div class="bar-container">
                        <div class="bar-fill bar-fill-alto" style="width: ${altoWidth}%"></div>
                        <div class="bar-fill bar-fill-medio" style="width: ${medioWidth}%"></div>
                        <div class="bar-inner-label" style="width: ${totalWidth}%">${label}</div>
                    </div>
                    <div class="bar-total-count">${counts.total}</div>
                </div>`;
        });

        const html = `
            <div class="chart-header">
                <h3 class="chart-title">Distribuci√≥n de Retos por GIT</h3>
                <div class="chart-legend">
                    <div class="legend-item"><div class="legend-color" style="background: #dc2626;"></div><span>Alto Impacto</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #f59e0b;"></div><span>Medio Impacto</span></div>
                </div>
            </div>
            <div class="progress-bars">${barsHtml}</div>`;
        document.getElementById('progress-chart').innerHTML = html;
    }

    function renderChallenges() {
        const impactFilter = impactFilterEl.value;
        const gitFilter = gitFilterEl.value;

        challengesContainer.innerHTML = ''; // Limpiar contenedor
        challengesData.forEach(c => {
            const impactMatch = impactFilter === 'all' || c.impact === impactFilter;
            const gitMatch = gitFilter === 'all' || c.git === gitFilter;
            
            const card = document.createElement('div');
            card.className = `challenge-card ${impactMatch && gitMatch ? 'visible' : ''}`;
            card.dataset.challengeId = c.id;
            
            card.innerHTML = `
                <div class="challenge-header">
                    <div class="challenge-info">
                        <div class="challenge-git">GIT ${c.git}</div>
                        <div class="challenge-title">${c.title}</div>
                    </div>
                    <span class="challenge-badge ${c.impact}">${c.impact}</span>
                </div>
                <div class="challenge-body">
                    <div class="challenge-section">
                        <div class="section-label">Impacto Potencial</div>
                        <div class="section-content">${c.impact_detail}</div>
                    </div>
                </div>
            `;
            challengesContainer.appendChild(card);
        });
        addCardEventListeners();
    }


    // --- L√ìGICA DE EVENTOS E INTERACTIVIDAD ---
    
    function setupEventListeners() {
        impactFilterEl.addEventListener('change', renderChallenges);
        gitFilterEl.addEventListener('change', renderChallenges);
        modalCloseBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });
    }

    function addCardEventListeners() {
        document.querySelectorAll('.challenge-card').forEach(card => {
            card.addEventListener('click', () => {
                showModal(card.dataset.challengeId);
            });
        });
    }

    window.applyFilters = function(filters) {
        if (filters.impact) {
            impactFilterEl.value = filters.impact;
        } else {
            impactFilterEl.value = 'all';
        }
        if (filters.git) {
            gitFilterEl.value = filters.git;
        } else {
            gitFilterEl.value = 'all';
        }
        renderChallenges();
        window.scrollTo({ top: document.getElementById('challenges-container').offsetTop - 80, behavior: 'smooth' });
    }

    window.showModal = function(id) {
        const challenge = challengesData.find(c => c.id == id);
        if (!challenge) return;

        document.getElementById('modal-title').textContent = challenge.title;
        document.getElementById('modal-body').innerHTML = `
            <div class="modal-section">
                <h4 class="modal-section-title"><i class="fa-solid fa-users-gear"></i> GIT Responsable</h4>
                <p>GIT ${challenge.git}</p>
            </div>
            <div class="modal-section">
                <h4 class="modal-section-title"><i class="fa-solid fa-triangle-exclamation"></i> Impacto Potencial</h4>
                <p>${challenge.impact_detail}</p>
            </div>
            <div class="modal-section">
                <h4 class="modal-section-title"><i class="fa-solid fa-lightbulb"></i> Propuesta de Abordaje</h4>
                ${challenge.proposal}
            </div>
             <div class="modal-section">
                <h4 class="modal-section-title"><i class="fa-solid fa-chart-line"></i> Estado Actual</h4>
                <p><b>Progreso:</b> ${challenge.progress}%</p>
                <p><b>Estatus:</b> <span style="text-transform:capitalize;">${challenge.status.replace('-', ' ')}</span></p>
            </div>
        `;
        modal.classList.add('active');
    }

    function closeModal() {
        modal.classList.remove('active');
    }

    // ===================================================================================
    // FUNCI√ìN DE NAVEGACI√ìN ACTUALIZADA - CONECTADA AL TABLERO PRINCIPAL
    // ===================================================================================
    window.goBack = function() {
        console.log('üîô Regresando al tablero principal...');
        
        // Mostrar mensaje de transici√≥n
        const transitionMessage = document.createElement('div');
        transitionMessage.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #003F78, #EC6608);
            color: white;
            padding: 25px 40px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            z-index: 10000;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        `;
        transitionMessage.innerHTML = `
            <div style="font-size: 2rem; margin-bottom: 10px;">üè†</div>
            <div>Regresando al Tablero Principal...</div>
        `;
        
        document.body.appendChild(transitionMessage);
        
        // Navegar despu√©s de un breve delay
        setTimeout(() => {
            try {
                // Intentar navegar al tablero principal
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error al navegar:', error);
                // Remover mensaje de transici√≥n si hay error
                if (transitionMessage.parentNode) {
                    transitionMessage.parentNode.removeChild(transitionMessage);
                }
                // Mostrar mensaje de error
                alert('‚ùå Error al regresar al tablero principal.\n\nVerifique que el archivo index.html existe en la misma carpeta.');
            }
        }, 1200);
    }

    // --- INICIALIZAR EL DASHBOARD ---
    init();
});
</script>
</body>
</html>